2D implementation using periodic boundary conditions.
